AWSTemplateFormatVersion: 2010-09-09
Description: CloudWatch Dashboard

Resources:
  FileServerDashboard:
    Type: AWS::CloudWatch::Dashboard
    Properties:
      DashboardName: FileServer
      DashboardBody: !Sub |
        {
          "widgets": [
            {
              "type": "metric",
              "properties": {
                "metrics": [
                  [ "OnPremises/FileServer", "CPU_IDLE", "host", "fileserver", "cpu", "cpu-total", { "stat": "Average", "label": "CPU Idle (%)" } ]
                ],
                "view": "timeSeries",
                "stacked": false,
                "region": "${AWS::Region}",
                "title": "CPU使用状況",
                "period": 300,
                "yAxis": {
                  "left": {
                    "min": 0,
                    "max": 100
                  }
                }
              },
              "width": 12,
              "height": 6,
              "x": 0,
              "y": 0
            },
            {
              "type": "metric",
              "properties": {
                "metrics": [
                  [ "OnPremises/FileServer", "MEM_USED_PERCENT", "host", "fileserver", { "stat": "Average", "label": "メモリ使用率 (%)" } ]
                ],
                "view": "timeSeries",
                "stacked": false,
                "region": "${AWS::Region}",
                "title": "メモリ使用率",
                "period": 300,
                "yAxis": {
                  "left": {
                    "min": 0,
                    "max": 100
                  }
                }
              },
              "width": 12,
              "height": 6,
              "x": 12,
              "y": 0
            },
            {
              "type": "metric",
              "properties": {
                "metrics": [
                  [ { "expression": "SEARCH('{OnPremises/FileServer,host,path,device,fstype} MetricName=\"DISK_USED_PERCENT\" host=\"fileserver\"', 'Average', 300)", "label": "${!PROP(\"path\")}", "id": "e1" } ]
                ],
                "view": "timeSeries",
                "stacked": false,
                "region": "${AWS::Region}",
                "title": "ディスク使用率 (%)",
                "period": 300,
                "yAxis": {
                  "left": {
                    "min": 0,
                    "max": 100
                  }
                }
              },
              "width": 12,
              "height": 6,
              "x": 0,
              "y": 6
            },
            {
              "type": "metric",
              "properties": {
                "metrics": [
                  [ "OnPremises/FileServer", "SWAP_USED_PERCENT", "host", "fileserver", { "stat": "Average", "label": "Swap使用率 (%)" } ]
                ],
                "view": "timeSeries",
                "stacked": false,
                "region": "${AWS::Region}",
                "title": "Swap使用率",
                "period": 300,
                "yAxis": {
                  "left": {
                    "min": 0,
                    "max": 100
                  }
                }
              },
              "width": 12,
              "height": 6,
              "x": 12,
              "y": 6
            }
          ]
        }

  BackupServerDashboard:
    Type: AWS::CloudWatch::Dashboard
    Properties:
      DashboardName: BackupServer
      DashboardBody: !Sub |
        {
          "widgets": [
            {
              "type": "metric",
              "properties": {
                "metrics": [
                  [ "OnPremises/BackupServer", "CPU_IDLE", "host", "backupserver", "cpu", "cpu-total", { "stat": "Average", "label": "CPU Idle (%)" } ]
                ],
                "view": "timeSeries",
                "stacked": false,
                "region": "${AWS::Region}",
                "title": "CPU使用状況",
                "period": 300,
                "yAxis": {
                  "left": {
                    "min": 0,
                    "max": 100
                  }
                }
              },
              "width": 12,
              "height": 6,
              "x": 0,
              "y": 0
            },
            {
              "type": "metric",
              "properties": {
                "metrics": [
                  [ "OnPremises/BackupServer", "MEM_USED_PERCENT", "host", "backupserver", { "stat": "Average", "label": "メモリ使用率 (%)" } ]
                ],
                "view": "timeSeries",
                "stacked": false,
                "region": "${AWS::Region}",
                "title": "メモリ使用率",
                "period": 300,
                "yAxis": {
                  "left": {
                    "min": 0,
                    "max": 100
                  }
                }
              },
              "width": 12,
              "height": 6,
              "x": 12,
              "y": 0
            },
            {
              "type": "metric",
              "properties": {
                "metrics": [
                  [ { "expression": "SEARCH('{OnPremises/BackupServer,host,path,device,fstype} MetricName=\"DISK_USED_PERCENT\" host=\"backupserver\"', 'Average', 300)", "label": "${!PROP(\"path\")}", "id": "e1" } ]
                ],
                "view": "timeSeries",
                "stacked": false,
                "region": "${AWS::Region}",
                "title": "ディスク使用率 (%)",
                "period": 300,
                "yAxis": {
                  "left": {
                    "min": 0,
                    "max": 100
                  }
                }
              },
              "width": 12,
              "height": 6,
              "x": 0,
              "y": 6
            },
            {
              "type": "metric",
              "properties": {
                "metrics": [
                  [ "OnPremises/BackupServer", "SWAP_USED_PERCENT", "host", "backupserver", { "stat": "Average", "label": "Swap使用率 (%)" } ]
                ],
                "view": "timeSeries",
                "stacked": false,
                "region": "${AWS::Region}",
                "title": "Swap使用率",
                "period": 300,
                "yAxis": {
                  "left": {
                    "min": 0,
                    "max": 100
                  }
                }
              },
              "width": 12,
              "height": 6,
              "x": 12,
              "y": 6
            }
          ]
        }
